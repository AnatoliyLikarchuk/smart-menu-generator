<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –ø–µ—Ä–µ–≤–æ–¥–æ–≤</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; border-left: 5px solid #28a745; }
        .pending { background: #fff3cd; border-left: 5px solid #ffc107; }
        .error { background: #f8d7da; border-left: 5px solid #dc3545; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .ingredient { display: flex; justify-content: space-between; margin: 5px 0; }
        .original { color: #666; }
        .translated { color: #28a745; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤</h1>
        
        <button onclick="testTranslations()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
        
        <div id="results"></div>
    </div>

    <script type="module">
        // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Å–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–≤–æ–¥–∞
        import TranslationService from '../services/translationService.js';
        
        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        const testDish = {
            idMeal: "52874",
            strMeal: "Chicken Tikka Masala",
            strCategory: "Chicken", 
            strArea: "Indian",
            strIngredient1: "Chicken",
            strIngredient2: "Plain Flour",
            strIngredient3: "Vegetable Oil", 
            strIngredient4: "Onion",
            strIngredient5: "Garlic",
            strIngredient6: "Ginger",
            strIngredient7: "Tomatoes",
            strIngredient8: "Cumin",
            strIngredient9: "Coriander",
            strIngredient10: "Paprika"
        };

        window.testTranslations = async function() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="test-result pending">üîÑ –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç –ø–µ—Ä–µ–≤–æ–¥–æ–≤...</div>';
            
            try {
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–µ—Ä–µ–≤–æ–¥ –±–ª—é–¥–∞
                resultsDiv.innerHTML += '<div class="test-result pending">üìù –ü–µ—Ä–µ–≤–æ–¥–∏–º –±–ª—é–¥–æ...</div>';
                
                const translatedDish = await TranslationService.translateDish(testDish, true, true);
                
                let html = '<div class="test-result success">';
                html += '<h3>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–≤–æ–¥–∞:</h3>';
                html += `<p><strong>–ë–ª—é–¥–æ:</strong> ${testDish.strMeal} ‚Üí <span class="translated">${translatedDish.strMealRu || '–ù–ï –ü–ï–†–ï–í–ï–î–ï–ù–û'}</span></p>`;
                html += `<p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${testDish.strCategory} ‚Üí <span class="translated">${translatedDish.strCategoryRu || '–ù–ï –ü–ï–†–ï–í–ï–î–ï–ù–û'}</span></p>`;
                html += `<p><strong>–ö—É—Ö–Ω—è:</strong> ${testDish.strArea} ‚Üí <span class="translated">${translatedDish.strAreaRu || '–ù–ï –ü–ï–†–ï–í–ï–î–ï–ù–û'}</span></p>`;
                
                if (translatedDish.ingredientsRu) {
                    html += '<h4>ü•ò –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã:</h4>';
                    const ingredients = TranslationService.extractIngredients(testDish);
                    ingredients.forEach((ingredient, index) => {
                        const translation = translatedDish.ingredientsRu[index];
                        html += `<div class="ingredient">`;
                        html += `<span class="original">${ingredient}</span>`;
                        html += `<span class="translated">${translation || '–ù–ï –ü–ï–†–ï–í–ï–î–ï–ù–û'}</span>`;
                        html += `</div>`;
                    });
                }
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞
                const stats = TranslationService.getCacheStats();
                html += `<h4>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞:</h4>`;
                html += `<p>–≠–ª–µ–º–µ–Ω—Ç–æ–≤: ${stats.count}, –†–∞–∑–º–µ—Ä: ${stats.sizeKB} KB</p>`;
                html += '</div>';
                
                resultsDiv.innerHTML += html;
                
            } catch (error) {
                resultsDiv.innerHTML += `<div class="test-result error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
                console.error('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞:', error);
            }
        };
    </script>
</body>
</html>